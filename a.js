(function () { function a(a, b) { return function () { a.apply(b, arguments) } } function b(b) { if ("object" != typeof this) throw new TypeError("Promises must be constructed via new"); if ("function" != typeof b) throw new TypeError("not a function"); this._state = null, this._value = null, this._deferreds = [], i(b, a(d, this), a(f, this)) } function c(a) { var b = this; return null === this._state ? void this._deferreds.push(a) : void k(function () { var c = b._state ? a.onFulfilled : a.onRejected; if (null === c) return void (b._state ? a.resolve : a.reject)(b._value); var d; try { d = c(b._value) } catch (b) { return void a.reject(b) } a.resolve(d) }) } function d(b) { try { if (b === this) throw new TypeError("A promise cannot be resolved with itself."); if (b && ("object" == typeof b || "function" == typeof b)) { var c = b.then; if ("function" == typeof c) return void i(a(c, b), a(d, this), a(f, this)) } this._state = !0, this._value = b, g.call(this) } catch (a) { f.call(this, a) } } function f(a) { this._state = !1, this._value = a, g.call(this) } function g() { for (var a = 0, b = this._deferreds.length; a < b; a++)c.call(this, this._deferreds[a]); this._deferreds = null } function h(a, b, c, d) { this.onFulfilled = "function" == typeof a ? a : null, this.onRejected = "function" == typeof b ? b : null, this.resolve = c, this.reject = d } function i(a, b, c) { var d = !1; try { a(function (a) { d || (d = !0, b(a)) }, function (a) { d || (d = !0, c(a)) }) } catch (a) { if (d) return; d = !0, c(a) } } var j; j = "object" == typeof window && window ? window : global, "undefined" != typeof module && module.exports ? module.exports = j.Promise ? j.Promise : b : !j.Promise && (j.Promise = b); var k = j.setImmediate || function (a) { setTimeout(a, 1) }, l = Array.isArray || function (a) { return "[object Array]" === Object.prototype.toString.call(a) }; b.prototype["catch"] = function (a) { return this.then(null, a) }, b.prototype.then = function (a, d) { var e = this; return new b(function (b, f) { c.call(e, new h(a, d, b, f)) }) }, b.all = function () { var a = Array.prototype.slice.call(1 === arguments.length && l(arguments[0]) ? arguments[0] : arguments); return new b(function (b, c) { function d(f, g) { try { if (g && ("object" == typeof g || "function" == typeof g)) { var h = g.then; if ("function" == typeof h) return void h.call(g, function (a) { d(f, a) }, c) } a[f] = g, 0 == --e && b(a) } catch (a) { c(a) } } if (0 === a.length) return b([]); for (var e = a.length, f = 0; f < a.length; f++)d(f, a[f]) }) }, b.resolve = function (a) { return a && "object" == typeof a && a.constructor === b ? a : new b(function (b) { b(a) }) }, b.reject = function (a) { return new b(function (b, c) { c(a) }) }, b.race = function (a) { return new b(function (b, c) { for (var d = 0, e = a.length; d < e; d++)a[d].then(b, c) }) } })();